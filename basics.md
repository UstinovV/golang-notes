1. Структура проекта
2. Сервер как структура
  * Зависимости
  * Обработчики, middleware
3. Запуск, остановка сервера  

<h4>Структура проекта</h4>
Основные идеи подчерпнуты из этой [статьи](https://tutorialedge.net/golang/go-project-structure-best-practices/)

**Плоская архитектура**
Подходит для маленьких проектов

**Модульная архитектура**
Подходит для маленьких и средних проектов

**Standart project layout**
Неофицально принятая в сообществе [архитектура](https://github.com/golang-standards/project-layout)

---

<h4>Сервер как структура</h4>
Самая идея как отсылка к стандартной библиотеке, смотри `http.Server`

**Что делаем:** 
Создаём сервер как отдельный тип(структуру) в которую включаем все зависимости. 
Идея взята из стандартной библиотеки, смотри структуру `http.Server`

**Что даёт:**
Таким образом мы сможем избежать глобальных переменных, что является плохой практикой
```golang
type server struct {
  db     *Database
  logger *Logger
  router *Router
}
```

**Что делаем:** 
Обработчики(handlers) в данном случае являются методами структуры. 

**Что даёт:**
Позволяет обеспечить обработчикам доступ к зависимостям включённым в структуру сервера 
```golang
func (s *server) handleSomething() http.HandlerFunc { ... }
```

**Что делаем:** 
В качестве обработчиков лучше использовать не просто функции которые которые реализуют интерфейс `http.Handler`, 
например `func handleAction(w http.ResponseWriter, r *http.Request)`,
а функции которые возвращают такой обработчик, например:
```golang
func (s *server) handleSomething(responseFormat string) http.HandlerFunc {
    //do something
    result := doSomething()
    return func(w http.ResponseWriter, r *http.Request) {
      fmt.Fprintf(w, format, result)
    }
}
```

**Что даёт:**
* можем реализовать механизм middlware, т.к. функции могут вкладываться друг в друга, это позволит к примеру проверять авторизацию, включать дополнительную бизнес логику непосредственно перед выполнением функции-обработчика и т.п, результат работы преварительного когда так же можно использовать в функции-обаботчике. В данном примере это `doSomething()`
* если в обработчике требуются дополнительные параметры, которые будут уникальны только для этого обработчика и которые мы не хотим включать в качестве зависимостей в структуру сервера, мы можем передать их в качестве аргумента в функцию обёртки (`responseFormat`)

---

Links
- https://pace.dev/blog/2018/05/09/how-I-write-http-services-after-eight-years.html
- https://tutorialedge.net/golang/
...

TODO
* линтеры
* тестирование
* профилирование